# Notion Astro Rev - Notion-Astro 博客模板

> Base Blog Template: [fuwari](https://github.com/saicaca/fuwari)
>
> This doc is generated by Claude 3.7 & Windsurf based on project info

If you are looking for `@chlorinec-pkgs/notion-astro-loader`, please check out [notion-astro-loader](https://github.com/KiritoKing/notion-astro-loader).

一个现代化的博客模板，基于 [Astro](https://astro.build) 构建，并由 [notion-astro-loader](https://github.com/KiritoKing/notion-astro-loader) 提供 Notion 无缝集成。

[**🌏 English**](./README.md)

> README 版本：`2025-04-17`

## 🌟 项目介绍

本项目作为 `notion-astro-loader` 包的模板博客，允许您使用 Notion 作为 CMS 创建美观、快速且对 SEO 友好的博客。使用这个模板，您可以：

- 在 Notion 中编写和管理博客内容
- 自动将内容同步到基于 Astro 的博客
- 享受现代、响应式设计和流畅的动画
- 自定义外观以匹配您的个人风格
- 轻松部署到 Vercel、Netlify 或 GitHub Pages 等平台

## ✨ 功能特性

- [x] **Notion 集成**：使用 `notion-astro-loader` 将 Notion 作为 CMS
- [x] **现代设计**：基于 Astro 和 Tailwind CSS 构建
- [x] **高性能**：静态站点生成以获得最佳速度
- [x] **流畅过渡**：页面过渡和动画
- [x] **主题**：亮色/暗色模式和可自定义的主题颜色
- [x] **响应式**：移动端友好设计
- [x] **搜索**：内置搜索功能
- [x] **URL 迁移**：从其他博客平台迁移的工具
- [x] **E2E 测试**：Playwright 测试 URL 重定向和功能

## 🚀 快速开始

### 前置条件

- [Node.js](https://nodejs.org/) (v18 或更高版本)
- [pnpm](https://pnpm.io/) (推荐的包管理器)
- Notion 账户和用于博客文章的数据库

### 安装设置

1. 克隆此仓库：

   ```bash
   git clone https://github.com/yourusername/notion-astro-rev.git
   cd notion-astro-rev
   ```

2. 安装依赖：

   ```bash
   pnpm install
   pnpm add sharp
   ```

3. 在根目录创建 `.env` 文件，包含您的 Notion 凭证：

   ```env
   NOTION_TOKEN=your_notion_integration_token
   NOTION_DATABASE_ID=your_notion_database_id
   ```

4. 启动开发服务器：

   ```bash
   pnpm dev
   ```

5. 打开浏览器并访问 `http://localhost:4321`

### 技术栈

- **[Astro](https://astro.build)**：快速、现代的静态站点生成器
- **[Tailwind CSS](https://tailwindcss.com)**：实用为先的 CSS 框架
- **[Svelte](https://svelte.dev)**：用于交互元素的组件框架
- **[notion-astro-loader](https://github.com/KiritoKing/notion-astro-loader)**：Astro 的 Notion 集成
- **[Playwright](https://playwright.dev)**：端到端测试框架
- **[TypeScript](https://www.typescriptlang.org/)**：类型安全的 JavaScript

## 🛠️ 自定义

### 配置

主要配置文件位于 `src` 目录：

- `config.ts`：一般站点配置（标题、主题、导航等）
- `content.config.ts`：Notion 集成配置

### Notion 数据库设置

您的 Notion 数据库应包含以下属性以获得最佳兼容性：

- `title` (标题)：文章标题
- `date` (日期)：发布日期
- `status` (选择)：发布状态（如“已发布”、“草稿”）
- `tags` (多选)：文章标签
- `category` (选择)：文章分类
- `description` (文本)：用于 SEO 和预览的简要描述
- `image` (URL 或文件与媒体)：封面图片

### 主题自定义

编辑 `src/config.ts` 文件以自定义：

- 站点标题和副标题
- 主题颜色和外观
- 导航链接
- 个人资料信息
- 横幅图片
- 许可证信息

## 🚀 高级功能

### URL 迁移

该模板包含从其他博客平台迁移的工具，通过设置 URL 重定向。迁移系统工作原理如下：

1. 在 `migration/url-map.json` 中定义您的 URL 映射
2. 格式为 `{"new-url": ["old-url-1", "old-url-2", ...]}`
3. 系统自动创建从所有旧 URL 到新 URL 的重定向
4. `tests/e2e/url-redirects.spec.ts` 中的 E2E 测试验证重定向是否正常工作

URL 映射示例：

```json
{
  "my-new-post": ["2023/01/01/old-post", "post/category/old-post", "/old-post", "/blog/old-post"]
}
```

### 测试

项目包含 Playwright 测试，用于验证 URL 重定向和其他功能：

```bash
pnpm test:e2e
```

## 🧞 命令

所有命令均在项目根目录执行：

| Command                            | Action                                 |
| :--------------------------------- | :------------------------------------- |
| `pnpm install` 并 `pnpm add sharp` | 安装依赖                               |
| `pnpm dev`                         | 在 `localhost:4321` 启动本地开发服务器 |
| `pnpm build`                       | 构建网站至 `./dist/`                   |
| `pnpm preview`                     | 本地预览已构建的网站                   |
| `pnpm test:e2e`                    | 运行 Playwright E2E 测试               |
| `pnpm lint`                        | 运行 ESLint 检查代码质量               |
| `pnpm format`                      | 使用 Prettier 格式化代码               |
| `pnpm astro ...`                   | 执行 `astro add`, `astro check` 等指令 |
| `pnpm astro --help`                | 显示 Astro CLI 帮助                    |
